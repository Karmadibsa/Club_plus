<!DOCTYPE html>
<html lang="fr">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Gestion des Événements</title>
    <link rel="stylesheet" href="../../css/base/root.css" />
    <link rel="stylesheet" href="../../css/components/sidebar.css" />
    <link
      rel="stylesheet"
      href="../../css/pages/compteadmin/admin_evenements.css"
    />
    <link
      href="https://fonts.googleapis.com/css2?family=Poppins:wght@300;400;500;600;700&display=swap"
      rel="stylesheet"
    />
    <!-- Utilisation d'une version spécifique et stable de Lucide -->
    <script src="https://cdn.jsdelivr.net/npm/lucide@0.263.0/dist/umd/lucide.min.js"></script>

    <!-- Styles pour la modal de confirmation -->
    <style>
      .modal-overlay {
        position: fixed;
        top: 0;
        left: 0;
        right: 0;
        bottom: 0;
        background-color: rgba(0, 0, 0, 0.65);
        display: flex;
        align-items: center;
        justify-content: center;
        z-index: 1000;
        opacity: 0;
        visibility: hidden;
        transition: opacity 0.3s, visibility 0.3s;
        backdrop-filter: blur(3px);
      }

      .modal-overlay.show {
        opacity: 1;
        visibility: visible;
      }

      .modal-container {
        background-color: white;
        border-radius: 12px;
        width: 90%;
        max-width: 450px;
        box-shadow: 0 6px 30px rgba(0, 0, 0, 0.2);
        transform: translateY(20px);
        transition: transform 0.3s ease;
        overflow: hidden;
        border: 1px solid rgba(0, 0, 0, 0.08);
      }

      .modal-overlay.show .modal-container {
        transform: translateY(0);
      }

      .modal-header {
        background-color: #f8f8f8;
        padding: 20px 24px;
        border-bottom: 1px solid #eaeaea;
        display: flex;
        align-items: center;
        gap: 16px;
      }

      .modal-header-icon {
        background-color: rgba(231, 76, 60, 0.1);
        color: var(--danger);
        width: 48px;
        height: 48px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
      }

      .modal-header-icon svg {
        width: 24px;
        height: 24px;
      }

      .modal-content {
        padding: 24px;
      }

      .modal-content h3 {
        margin-top: 0;
        margin-bottom: 16px;
        color: var(--text-dark);
        font-size: 18px;
      }

      .modal-content p {
        margin: 8px 0;
        color: var(--text-medium);
        font-size: 14px;
        line-height: 1.5;
      }

      .modal-content p.warning {
        color: var(--danger);
        font-weight: 500;
      }

      .modal-actions {
        display: flex;
        justify-content: flex-end;
        gap: 12px;
        margin-top: 24px;
        padding-top: 16px;
        border-top: 1px solid #eaeaea;
      }

      .cancel-btn,
      .confirm-btn {
        padding: 10px 20px;
        border-radius: 6px;
        border: none;
        font-weight: 500;
        cursor: pointer;
        font-size: 14px;
        transition: all 0.2s ease;
      }

      .cancel-btn {
        background-color: #f0f0f0;
        color: var(--text-dark);
      }

      .cancel-btn:hover {
        background-color: #e0e0e0;
      }

      .confirm-btn {
        background-color: var(--danger);
        color: white;
      }

      .confirm-btn:hover {
        background-color: #c0392b;
      }

      @media (max-width: 768px) {
        .modal-container {
          width: 95%;
        }

        .modal-actions {
          flex-direction: column;
        }

        .cancel-btn,
        .confirm-btn {
          width: 100%;
          padding: 12px;
          font-size: 16px;
        }

        .cancel-btn {
          order: 2;
        }

        .confirm-btn {
          order: 1;
        }
      }

      /* Styles pour les boutons d'action */
      .action-btn.view-btn,
      .card-action-btn.view-btn {
        color: var(--main-blue);
        background-color: transparent; /* Fond transparent au lieu de bleuté */
      }

      .action-btn.view-btn:hover,
      .card-action-btn.view-btn:hover {
        background-color: var(--main-blue);
        color: white;
      }

      .view-btn i {
        color: inherit;
      }

      .action-btn-container {
        display: flex;
        gap: 6px;
      }

      /* Spécifique pour mobile - garder le fond bleuté */
      @media (max-width: 768px) {
        .card-action-btn.view-btn {
          background-color: rgba(24, 119, 242, 0.1);
        }
      }
    </style>
  </head>
  <body>
    <!-- Header pour mobile -->
    <header class="mobile-header">
      <div class="logo-container">
        <img
          src="../../assets/images/LogoClubPlussansfond.png"
          alt="Logo Club Plus"
          class="logo"
        />
      </div>
      <div class="mobile-header-right">
        <a
          href="../public/public_connexion.html"
          class="mobile-logout-btn"
          title="Déconnexion"
        >
          <i data-lucide="log-out"></i>
        </a>
      </div>
    </header>

    <div class="main-layout">
      <!-- Sidebar pour la navigation desktop -->
      <div class="sidebar">
        <div class="logo-container">
          <img
            src="../../assets/images/LogoClubPlussansfond.png"
            alt="Logo Club Plus"
            class="logo"
          />
        </div>
        <!-- Sidebar Navigation -->
        <ul class="menu-items">
          <li>
            <a href="reservation_dashboard.html">
              <i data-lucide="layout-dashboard"></i>
              Dashboard
            </a>
          </li>
          <li>
            <a href="reservation_evenement.html" class="active">
              <i data-lucide="calendar"></i>
              Événements
            </a>
          </li>
          <li>
            <a href="reservation_membres.html">
              <i data-lucide="users"></i>
              Membres
            </a>
          </li>
        </ul>
        <div class="sidebar-footer">
          <a
            href="../public/public_connexion.html"
            class="logout-btn"
            title="Déconnexion"
          >
            <i data-lucide="log-out"></i>
          </a>
        </div>
      </div>

      <div class="container-page">
        <div class="container">
          <header class="main-header">
            <h1>Les Événements du Club</h1>

            <!-- Section info événements -->
            <div class="event-info-container">
              <div class="event-info">
                <h3>Gestion des Événements</h3>
                <p>
                  Créez, modifiez ou supprimez des événements pour votre club.
                  Suivez les inscriptions et la participation.
                </p>
              </div>
              <div class="event-action">
                <button
                  class="add-event-btn"
                  title="Créer un événement"
                  onclick="window.location.href='reservation_editevenement.html'"
                >
                  <i data-lucide="calendar-plus"></i>
                  <span>Créer un événement</span>
                </button>
              </div>
            </div>

            <div class="header-actions">
              <div class="search-wrapper">
                <!-- Barre de recherche améliorée -->
                <div class="search-container">
                  <i data-lucide="search" class="search-icon"></i>
                  <input
                    type="text"
                    placeholder="Rechercher un événement"
                    class="search-input"
                    id="event-search"
                  />
                </div>

                <!-- Filtres horizontaux directement visibles -->
                <div class="inline-filters">
                  <!-- Titre des filtres avec bouton toggle pour mobile -->
                  <div class="filters-mobile-header">
                    <h4>Filtres</h4>
                    <button id="toggleFilters" class="toggle-filters-btn">
                      <i data-lucide="sliders"></i>
                    </button>
                  </div>

                  <!-- Conteneur de filtres qui peut être caché/affiché sur mobile -->
                  <div id="filtersContainer" class="filters-container-mobile">
                    <div class="filter-group horizontal">
                      <label>Statut:</label>
                      <div class="filter-options horizontal">
                        <label class="filter-option">
                          <input
                            type="checkbox"
                            name="status"
                            value="upcoming"
                            checked
                          />
                          <span class="status-indicator upcoming"></span>
                          À venir
                        </label>
                        <label class="filter-option">
                          <input
                            type="checkbox"
                            name="status"
                            value="full"
                            checked
                          />
                          <span class="status-indicator full"></span>
                          Complet
                        </label>
                        <label class="filter-option">
                          <input
                            type="checkbox"
                            name="status"
                            value="past"
                            checked
                          />
                          <span class="status-indicator past"></span>
                          Terminé
                        </label>
                      </div>
                    </div>
                    <div class="filter-group horizontal date-filters">
                      <label>Période:</label>
                      <div class="filter-date-range horizontal">
                        <div class="date-input-wrapper">
                          <label for="dateFrom" class="mobile-date-label"
                            >Du</label
                          >
                          <input
                            type="date"
                            id="dateFrom"
                            name="dateFrom"
                            placeholder="Du"
                          />
                        </div>
                        <span class="date-separator">-</span>
                        <div class="date-input-wrapper">
                          <label for="dateTo" class="mobile-date-label"
                            >Au</label
                          >
                          <input
                            type="date"
                            id="dateTo"
                            name="dateTo"
                            placeholder="Au"
                          />
                        </div>
                      </div>
                      <div class="filter-actions">
                        <button class="apply-filters-btn" id="applyFilters">
                          Appliquer
                        </button>
                        <button class="reset-filters-btn" id="resetFilters">
                          Réinitialiser
                        </button>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </header>

          <main>
            <div class="events-list">
              <!-- Mobile events cards view -->
              <div class="mobile-events-cards">
                <!-- Exemple pour chaque événement -->
                <div class="event-card" data-status="upcoming" data-id="1">
                  <div class="event-card-header">
                    <h3 class="event-title">Tournoi de Tennis</h3>
                    <span class="status-upcoming">À venir</span>
                  </div>
                  <div class="event-card-body">
                    <div class="event-detail">
                      <i data-lucide="calendar"></i>
                      <span>15/06/2023</span>
                    </div>
                    <div class="event-detail">
                      <i data-lucide="clock"></i>
                      <span>14:00 - 18:00</span>
                    </div>
                    <div class="event-detail">
                      <i data-lucide="map-pin"></i>
                      <span>Courts centraux</span>
                    </div>
                    <div class="event-detail">
                      <i data-lucide="users"></i>
                      <span>28 / 32 participants</span>
                    </div>
                  </div>
                  <div class="event-card-actions">
                    <a
                      href="reservation_evenement_details.html?id=1"
                      class="card-action-btn view-btn"
                    >
                      <i data-lucide="eye"></i>
                      Voir
                    </a>
                    <a
                      href="reservation_editevenement.html?id=1"
                      class="card-action-btn edit-btn"
                    >
                      <i data-lucide="pencil"></i>
                      Modifier
                    </a>
                    <button class="card-action-btn delete-btn">
                      <i data-lucide="trash-2"></i>
                      Supprimer
                    </button>
                  </div>
                </div>

                <div class="event-card" data-status="full" data-id="2">
                  <div class="event-card-header">
                    <h3 class="event-title">Match de Football Amical</h3>
                    <span class="status-full">Complet</span>
                  </div>
                  <div class="event-card-body">
                    <div class="event-detail">
                      <i data-lucide="calendar"></i>
                      <span>25/06/2023</span>
                    </div>
                    <div class="event-detail">
                      <i data-lucide="clock"></i>
                      <span>15:30 - 17:30</span>
                    </div>
                    <div class="event-detail">
                      <i data-lucide="map-pin"></i>
                      <span>Terrain principal</span>
                    </div>
                    <div class="event-detail">
                      <i data-lucide="users"></i>
                      <span>22 / 22 participants</span>
                    </div>
                  </div>
                  <div class="event-card-actions">
                    <a
                      href="reservation_evenement_details.html?id=2"
                      class="card-action-btn view-btn"
                    >
                      <i data-lucide="eye"></i>
                      Voir
                    </a>
                    <a
                      href="reservation_editevenement.html?id=2"
                      class="card-action-btn edit-btn"
                    >
                      <i data-lucide="pencil"></i>
                      Modifier
                    </a>
                    <button class="card-action-btn delete-btn">
                      <i data-lucide="trash-2"></i>
                      Supprimer
                    </button>
                  </div>
                </div>

                <div class="event-card" data-status="past" data-id="3">
                  <div class="event-card-header">
                    <h3 class="event-title">Séance de Yoga</h3>
                    <span class="status-past">Terminé</span>
                  </div>
                  <div class="event-card-body">
                    <div class="event-detail">
                      <i data-lucide="calendar"></i>
                      <span>05/05/2023</span>
                    </div>
                    <div class="event-detail">
                      <i data-lucide="clock"></i>
                      <span>09:00 - 10:30</span>
                    </div>
                    <div class="event-detail">
                      <i data-lucide="map-pin"></i>
                      <span>Salle de fitness</span>
                    </div>
                    <div class="event-detail">
                      <i data-lucide="users"></i>
                      <span>15 / 20 participants</span>
                    </div>
                  </div>
                  <div class="event-card-actions">
                    <a
                      href="reservation_evenement_details.html?id=3"
                      class="card-action-btn view-btn"
                    >
                      <i data-lucide="eye"></i>
                      Voir
                    </a>
                    <a
                      href="reservation_editevenement.html?id=3"
                      class="card-action-btn edit-btn"
                    >
                      <i data-lucide="pencil"></i>
                      Modifier
                    </a>
                    <button class="card-action-btn delete-btn">
                      <i data-lucide="trash-2"></i>
                      Supprimer
                    </button>
                  </div>
                </div>

                <!-- Ajoutez les autres cartes d'événements de la même façon -->
              </div>

              <!-- Table pour desktop -->
              <table class="events-table">
                <thead>
                  <tr>
                    <th>Titre</th>
                    <th>Date</th>
                    <th>Horaires</th>
                    <th>Lieu</th>
                    <th>Places</th>
                    <th>Participants</th>
                    <th>Statut</th>
                    <th>Actions</th>
                  </tr>
                </thead>
                <tbody>
                  <tr data-id="1">
                    <td>Tournoi de Tennis</td>
                    <td>15/06/2023</td>
                    <td>14:00 - 18:00</td>
                    <td>Courts centraux</td>
                    <td>32</td>
                    <td>28</td>
                    <td><span class="status-upcoming">À venir</span></td>
                    <td class="actions-cell">
                      <div class="action-btn-container">
                        <a
                          href="reservation_evenement_details.html?id=1"
                          class="action-btn view-btn"
                          title="Voir cet événement"
                        >
                          <i data-lucide="eye"></i>
                        </a>
                        <a
                          href="reservation_editevenement.html?id=1"
                          class="action-btn edit-btn"
                          title="Modifier cet événement"
                        >
                          <i data-lucide="pencil"></i>
                        </a>
                        <button
                          class="action-btn delete-btn"
                          title="Supprimer cet événement"
                        >
                          <i data-lucide="trash-2"></i>
                        </button>
                      </div>
                    </td>
                  </tr>
                  <tr data-id="2">
                    <td>Cours de Natation Avancé</td>
                    <td>20/06/2023</td>
                    <td>10:00 - 12:00</td>
                    <td>Piscine olympique</td>
                    <td>15</td>
                    <td>10</td>
                    <td><span class="status-upcoming">À venir</span></td>
                    <td class="actions-cell">
                      <div class="action-btn-container">
                        <a
                          href="reservation_evenement_details.html?id=2"
                          class="action-btn view-btn"
                          title="Voir cet événement"
                        >
                          <i data-lucide="eye"></i>
                        </a>
                        <a
                          href="reservation_editevenement.html?id=2"
                          class="action-btn edit-btn"
                          title="Modifier cet événement"
                        >
                          <i data-lucide="pencil"></i>
                        </a>
                        <button
                          class="action-btn delete-btn"
                          title="Supprimer cet événement"
                        >
                          <i data-lucide="trash-2"></i>
                        </button>
                      </div>
                    </td>
                  </tr>
                  <tr data-id="3">
                    <td>Match de Football Amical</td>
                    <td>25/06/2023</td>
                    <td>15:30 - 17:30</td>
                    <td>Terrain principal</td>
                    <td>22</td>
                    <td>22</td>
                    <td><span class="status-full">Complet</span></td>
                    <td class="actions-cell">
                      <div class="action-btn-container">
                        <a
                          href="reservation_evenement_details.html?id=3"
                          class="action-btn view-btn"
                          title="Voir cet événement"
                        >
                          <i data-lucide="eye"></i>
                        </a>
                        <a
                          href="reservation_editevenement.html?id=3"
                          class="action-btn edit-btn"
                          title="Modifier cet événement"
                        >
                          <i data-lucide="pencil"></i>
                        </a>
                        <button
                          class="action-btn delete-btn"
                          title="Supprimer cet événement"
                        >
                          <i data-lucide="trash-2"></i>
                        </button>
                      </div>
                    </td>
                  </tr>
                  <tr data-id="4">
                    <td>Séance de Yoga</td>
                    <td>05/05/2023</td>
                    <td>09:00 - 10:30</td>
                    <td>Salle de fitness</td>
                    <td>20</td>
                    <td>15</td>
                    <td><span class="status-past">Terminé</span></td>
                    <td class="actions-cell">
                      <div class="action-btn-container">
                        <a
                          href="reservation_evenement_details.html?id=4"
                          class="action-btn view-btn"
                          title="Voir cet événement"
                        >
                          <i data-lucide="eye"></i>
                        </a>
                        <a
                          href="reservation_editevenement.html?id=4"
                          class="action-btn edit-btn"
                          title="Modifier cet événement"
                        >
                          <i data-lucide="pencil"></i>
                        </a>
                        <button
                          class="action-btn delete-btn"
                          title="Supprimer cet événement"
                        >
                          <i data-lucide="trash-2"></i>
                        </button>
                      </div>
                    </td>
                  </tr>
                  <tr data-id="5">
                    <td>Atelier Nutrition Sportive</td>
                    <td>10/05/2023</td>
                    <td>18:30 - 20:00</td>
                    <td>Salle de conférence</td>
                    <td>30</td>
                    <td>25</td>
                    <td><span class="status-past">Terminé</span></td>
                    <td class="actions-cell">
                      <div class="action-btn-container">
                        <a
                          href="reservation_evenement_details.html?id=5"
                          class="action-btn view-btn"
                          title="Voir cet événement"
                        >
                          <i data-lucide="eye"></i>
                        </a>
                        <a
                          href="reservation_editevenement.html?id=5"
                          class="action-btn edit-btn"
                          title="Modifier cet événement"
                        >
                          <i data-lucide="pencil"></i>
                        </a>
                        <button
                          class="action-btn delete-btn"
                          title="Supprimer cet événement"
                        >
                          <i data-lucide="trash-2"></i>
                        </button>
                      </div>
                    </td>
                  </tr>
                  <tr data-id="6">
                    <td>Compétition d'Athlétisme</td>
                    <td>01/07/2023</td>
                    <td>09:00 - 17:00</td>
                    <td>Stade municipal</td>
                    <td>50</td>
                    <td>35</td>
                    <td><span class="status-upcoming">À venir</span></td>
                    <td class="actions-cell">
                      <div class="action-btn-container">
                        <a
                          href="reservation_evenement_details.html?id=6"
                          class="action-btn view-btn"
                          title="Voir cet événement"
                        >
                          <i data-lucide="eye"></i>
                        </a>
                        <a
                          href="reservation_editevenement.html?id=6"
                          class="action-btn edit-btn"
                          title="Modifier cet événement"
                        >
                          <i data-lucide="pencil"></i>
                        </a>
                        <button
                          class="action-btn delete-btn"
                          title="Supprimer cet événement"
                        >
                          <i data-lucide="trash-2"></i>
                        </button>
                      </div>
                    </td>
                  </tr>
                  <tr data-id="7">
                    <td>Soirée Remise des Prix</td>
                    <td>15/07/2023</td>
                    <td>19:00 - 22:00</td>
                    <td>Grande salle</td>
                    <td>100</td>
                    <td>78</td>
                    <td><span class="status-upcoming">À venir</span></td>
                    <td class="actions-cell">
                      <div class="action-btn-container">
                        <a
                          href="reservation_evenement_details.html?id=7"
                          class="action-btn view-btn"
                          title="Voir cet événement"
                        >
                          <i data-lucide="eye"></i>
                        </a>
                        <a
                          href="reservation_editevenement.html?id=7"
                          class="action-btn edit-btn"
                          title="Modifier cet événement"
                        >
                          <i data-lucide="pencil"></i>
                        </a>
                        <button
                          class="action-btn delete-btn"
                          title="Supprimer cet événement"
                        >
                          <i data-lucide="trash-2"></i>
                        </button>
                      </div>
                    </td>
                  </tr>
                </tbody>
              </table>

              <div class="pagination">
                <button class="pagination-btn">
                  <i data-lucide="chevron-left"></i> Précédent
                </button>
                <button class="pagination-btn active">1</button>
                <button class="pagination-btn">2</button>
                <button class="pagination-btn">3</button>
                <span class="pagination-ellipsis">...</span>
                <button class="pagination-btn">5</button>
                <button class="pagination-btn">
                  Suivant <i data-lucide="chevron-right"></i>
                </button>
              </div>
            </div>
          </main>
        </div>
      </div>
    </div>

    <!-- Navigation mobile -->
    <nav class="mobile-nav">
      <a href="reservation_dashboard.html" class="nav-item">
        <i data-lucide="layout-dashboard"></i>
        <span>Dashboard</span>
      </a>
      <a href="reservation_evenement.html" class="nav-item active">
        <i data-lucide="calendar"></i>
        <span>Événements</span>
      </a>
      <a href="reservation_membres.html" class="nav-item">
        <i data-lucide="users"></i>
        <span>Membres</span>
      </a>
    </nav>

    <!-- Modal de confirmation de suppression -->
    <div class="modal-overlay" id="deleteModal">
      <div class="modal-container">
        <div class="modal-header">
          <div class="modal-header-icon">
            <i data-lucide="trash-2"></i>
          </div>
          <h3>Confirmer la suppression</h3>
        </div>
        <div class="modal-content">
          <p>Vous êtes sur le point de supprimer l'événement :</p>
          <p
            id="eventNameToDelete"
            style="font-weight: 600; margin: 10px 0"
          ></p>
          <p class="warning">
            Cette action est irréversible et supprimera toutes les données
            associées à cet événement.
          </p>
          <div class="modal-actions">
            <button id="cancelDelete" class="cancel-btn">Annuler</button>
            <button id="confirmDelete" class="confirm-btn">
              Supprimer définitivement
            </button>
          </div>
        </div>
      </div>
    </div>

    <!-- Initialisation de Lucide avec meilleure gestion d'erreur -->
    <script>
      document.addEventListener("DOMContentLoaded", function () {
        // Initialiser les icônes Lucide
        if (typeof lucide !== "undefined") {
          lucide.createIcons();
          console.log("Icônes Lucide initialisées avec succès");
        } else {
          console.error("La bibliothèque Lucide n'a pas pu être chargée");
        }

        // Gestion de la modal de confirmation de suppression
        const deleteModal = document.getElementById("deleteModal");
        const cancelDelete = document.getElementById("cancelDelete");
        const confirmDelete = document.getElementById("confirmDelete");
        const eventNameToDelete = document.getElementById("eventNameToDelete");
        let currentEventId = null;

        // Ajouter les événements de clic à tous les boutons de suppression
        document.querySelectorAll(".delete-btn").forEach((btn) => {
          btn.addEventListener("click", function (e) {
            console.log("Bouton de suppression cliqué");
            e.preventDefault(); // Empêcher toute action par défaut
            e.stopPropagation(); // Empêcher la propagation de l'événement

            // Récupérer l'ID de l'événement depuis le tr ou la card parent
            const eventContainer = this.closest("[data-id]");
            currentEventId = eventContainer
              ? eventContainer.getAttribute("data-id")
              : null;

            // Récupérer le nom de l'événement
            let eventName = "";
            if (eventContainer) {
              // Si c'est une carte mobile
              if (eventContainer.classList.contains("event-card")) {
                eventName =
                  eventContainer.querySelector(".event-title").textContent;
              }
              // Si c'est une ligne de tableau
              else {
                eventName = eventContainer.cells[0].textContent;
              }
            } else {
              // Fallback pour les éléments sans data-id
              // Pour les cartes mobile
              if (this.closest(".event-card")) {
                eventName =
                  this.closest(".event-card").querySelector(
                    ".event-title"
                  ).textContent;
              }
              // Pour les lignes de tableau
              else if (this.closest("tr")) {
                eventName = this.closest("tr").cells[0].textContent;
              }
            }

            // Afficher le nom dans la modal
            if (eventNameToDelete) {
              eventNameToDelete.textContent = eventName;
            }

            console.log(
              "ID de l'événement à supprimer:",
              currentEventId || "ID non trouvé"
            );

            // Afficher la modal
            if (deleteModal) {
              deleteModal.classList.add("show");
              console.log("Modal affichée");
            } else {
              console.error("Modal non trouvée");
            }
          });
        });

        // Fermer la modal quand on clique sur Annuler
        if (cancelDelete) {
          cancelDelete.addEventListener("click", function () {
            console.log("Annulation de la suppression");
            deleteModal.classList.remove("show");
            currentEventId = null;
          });
        }

        // Action quand on confirme la suppression
        if (confirmDelete) {
          confirmDelete.addEventListener("click", function () {
            console.log("Confirmation de la suppression");
            // Ici vous pouvez ajouter le code pour supprimer l'événement
            // Par exemple, une requête AJAX vers votre backend

            // Après suppression, on pourrait masquer l'élément dans l'UI
            if (currentEventId) {
              const eventElements = document.querySelectorAll(
                `[data-id="${currentEventId}"]`
              );
              eventElements.forEach((el) => (el.style.display = "none"));
            } else {
              // Fallback pour les éléments sans data-id
              // Trouver la carte ou la ligne correspondant à l'événement supprimé
              // et la masquer
              if (
                document.querySelector(".event-card:has(.delete-btn:focus)")
              ) {
                document.querySelector(
                  ".event-card:has(.delete-btn:focus)"
                ).style.display = "none";
              } else if (document.querySelector("tr:has(.delete-btn:focus)")) {
                document.querySelector(
                  "tr:has(.delete-btn:focus)"
                ).style.display = "none";
              }
            }

            // Fermer la modal
            deleteModal.classList.remove("show");
            currentEventId = null;
          });
        }

        // Toggle des filtres sur mobile
        const toggleFiltersBtn = document.getElementById("toggleFilters");
        const filtersContainer = document.getElementById("filtersContainer");

        if (toggleFiltersBtn && filtersContainer) {
          toggleFiltersBtn.addEventListener("click", function () {
            filtersContainer.classList.toggle("show");
            this.classList.toggle("active");
          });
        }

        // Fonctionnalité de recherche simple
        const searchInput = document.getElementById("event-search");
        const tableRows = document.querySelectorAll(".events-table tbody tr");
        const eventCards = document.querySelectorAll(".event-card");
        const applyFiltersBtn = document.getElementById("applyFilters");
        const resetFiltersBtn = document.getElementById("resetFilters");

        // Appliquer les filtres aux tables et cartes
        function applyFilters() {
          const searchTerm = searchInput.value.toLowerCase();
          const statusFilters = Array.from(
            document.querySelectorAll(
              'input[type="checkbox"][name="status"]:checked'
            )
          ).map((cb) => cb.value);

          const dateFrom = document.getElementById("dateFrom").value;
          const dateTo = document.getElementById("dateTo").value;

          // Filtrer les lignes du tableau (desktop)
          tableRows.forEach((row) => {
            filterRow(row, searchTerm, statusFilters, dateFrom, dateTo);
          });

          // Filtrer les cartes d'événements (mobile)
          eventCards.forEach((card) => {
            filterCard(card, searchTerm, statusFilters, dateFrom, dateTo);
          });
        }

        function filterRow(row, searchTerm, statusFilters, dateFrom, dateTo) {
          const title = row.cells[0].textContent.toLowerCase();
          const location = row.cells[3].textContent.toLowerCase();
          const date = row.cells[1].textContent; // Format: dd/mm/yyyy

          // Convertir la date pour la comparaison
          let [day, month, year] = date.split("/");
          const eventDate = new Date(`${year}-${month}-${day}`);

          // Statut de l'événement
          let status;
          if (row.querySelector(".status-upcoming")) status = "upcoming";
          else if (row.querySelector(".status-full")) status = "full";
          else if (row.querySelector(".status-past")) status = "past";

          // Vérifier si le statut est dans les filtres sélectionnés
          const statusMatch = statusFilters.includes(status);

          // Vérifier si la date est dans la plage sélectionnée
          let dateMatch = checkDateRange(eventDate, dateFrom, dateTo);

          // Vérifier si le texte correspond à la recherche
          const textMatch =
            title.includes(searchTerm) || location.includes(searchTerm);

          // Afficher la ligne si tous les critères correspondent
          row.style.display =
            statusMatch && dateMatch && textMatch ? "" : "none";
        }

        function filterCard(card, searchTerm, statusFilters, dateFrom, dateTo) {
          const title = card
            .querySelector(".event-title")
            .textContent.toLowerCase();
          const location = card
            .querySelector(".event-detail:nth-of-type(3) span")
            .textContent.toLowerCase();
          const dateText = card.querySelector(
            ".event-detail:nth-of-type(1) span"
          ).textContent;

          // Convertir la date
          let [day, month, year] = dateText.split("/");
          const eventDate = new Date(`${year}-${month}-${day}`);

          // Statut de la carte
          const status = card.getAttribute("data-status");

          // Vérifications des filtres
          const statusMatch = statusFilters.includes(status);
          const dateMatch = checkDateRange(eventDate, dateFrom, dateTo);
          const textMatch =
            title.includes(searchTerm) || location.includes(searchTerm);

          // Afficher/masquer la carte
          card.style.display =
            statusMatch && dateMatch && textMatch ? "" : "none";
        }

        function checkDateRange(eventDate, dateFrom, dateTo) {
          let dateMatch = true;
          if (dateFrom) {
            const fromDate = new Date(dateFrom);
            dateMatch = dateMatch && eventDate >= fromDate;
          }
          if (dateTo) {
            const toDate = new Date(dateTo);
            dateMatch = dateMatch && eventDate <= toDate;
          }
          return dateMatch;
        }

        if (searchInput) {
          searchInput.addEventListener("input", applyFilters);
        }

        // Appliquer les filtres automatiquement au changement des checkboxes
        document
          .querySelectorAll('input[type="checkbox"][name="status"]')
          .forEach((checkbox) => {
            checkbox.addEventListener("change", applyFilters);
          });

        if (applyFiltersBtn) {
          applyFiltersBtn.addEventListener("click", applyFilters);
        }

        if (resetFiltersBtn) {
          resetFiltersBtn.addEventListener("click", function () {
            // Réinitialiser les checkboxes
            document
              .querySelectorAll('input[type="checkbox"][name="status"]')
              .forEach((checkbox) => {
                checkbox.checked = true;
              });

            // Réinitialiser les dates
            document.getElementById("dateFrom").value = "";
            document.getElementById("dateTo").value = "";

            applyFilters();

            // Sur mobile, réduire les filtres après réinitialisation
            if (window.innerWidth <= 768 && filtersContainer) {
              filtersContainer.classList.remove("show");
              if (toggleFiltersBtn) toggleFiltersBtn.classList.remove("active");
            }
          });
        }

        // Amélioration de la gestion des boutons de vue
        document.querySelectorAll(".view-btn").forEach((viewBtn) => {
          viewBtn.addEventListener("click", function (e) {
            // Pour le débogage
            console.log("Clic sur bouton view-btn détecté");
            console.log("URL cible:", this.getAttribute("href"));

            // Forcer la navigation
            const url = this.getAttribute("href");
            if (url) {
              window.location.href = url;
            }
          });
        });
      });
    </script>
  </body>
</html>
